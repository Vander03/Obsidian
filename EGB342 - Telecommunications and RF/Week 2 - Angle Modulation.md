## 1 Introduction to Phase and Frequency Modulation
Major problem of AM is static noise as amplitude variations due to noise cannot be removed from de-modulated signals. Phase and Frequency Modulation vary, or modulate, the waves frequency over a wide band of frequencies. These are **non-linear modulation schemes**. 

**Characteristics**
- High bandwidth requirements
- Good performance in presence of noise

**FM used in**
- High-Fidelity radio broadcasting
- TV Broadcasting
- Microwave carrier modulation
- Point-to-point communication systems

### 1.1 General Description
Angle-Modulated signal is generated by modulating the message $m(t)$ on to the phase $\phi(t)$ of the carrier:
$$
s(t) = A_c\cos[2\pi f_ct + \phi(t)]
$$
The instantaneous frequency (rate of change of phase with time) of the carrier $s(t)$:
$$\begin{align}
& f_i(t) = f_c + \frac{1}{2\pi} \frac{d\phi (t)}{dt} \\
& \text{or} \\
& \omega_i(t) = 2\pi f_c + \frac{d}{dt}\phi(t)

\end{align}$$
---
### 1.2 Phase Modulation
Phase of the carrier is changed by the message signal, $m(t)$, where phase is proportional to the message $m(t)$. In the formula below $k_p$ is the **phase deviation constant**:
$$\phi(t) = k_pm(t)$$

**Modulated Signal**
$$s(t) = A_c\cos[2\pi f_c t + \mathbf{k_p m(t)}]$$
**Modulation Index for Phase Modulation**

$$\begin{align}
& \beta_p = k_p A_m & \text{Single Tone Modulation} \\
& \beta_p = k_p \max|m(t)| = \Delta p & \text{General Signal}\space m(t)
\end{align}$$
Where
- $\Delta p$ - maximum phase deviation

**Single Tone Modulation**

![[Pasted image 20240730172131.png#invert_B|400]]


---
### 1.3 Frequency Modulation
Frequency of the carrier $f_c$ is changed by the message signal, $m(t)$, where the frequency deviation is proportional to the message signal $m(t)$. In the formula below $k_f$ is the **frequency deviation constant**:
$$\begin{align}
& f_i(t) - f_c = \frac{1}{2\pi} \frac{d\phi (t)}{dt} = k_fm(t) \\
& \phi(t) = 2\pi k_f \int_0^t m(\tau) d\tau

\end{align}$$
 **Modulated Signal**
$$s(t) = A_c \cos[2\pi f_c t + \mathbf{2 \pi k_f \int^t_0 m(\tau)d\tau}]$$
**Modulation Index for Frequency Modulation**

$$\begin{align}
& \beta_f = \frac{k_f A_m}{f_m} & \text{Single Tone Modulation} \\
& \beta_f = \frac{k_f \max|m(t)|}{B} = \frac{\Delta f}{B} & \text{General Signal } m(t) \\ 
\end{align}$$
Where
- $B$ - bandwidth of the message signal
- $\Delta f$ - maximum frequency deviation

**Single Tone Modulation**

![[Pasted image 20240730172218.png#invert_B|400]]
![[Pasted image 20240730172331.png#invert_B|400]]



---
![[Pasted image 20240730165353.png#invert_B]]
### 1.4 Summary and Graphs


![[Pasted image 20240730165453.png#invert_B|700]]
![[Pasted image 20240730164123.png#invert_B|500]]



### 1.5 FM Example 1
[[AM mod example 1.jpeg]]




### 1.6 Bandwidth

#### 1.6.1 Factors Influencing Bandwidth
For a general message signal $m(t)$ with bandwidth $W$ Hz:
*recall $\beta_p = k_p \max|m(t)|$ and $\beta_f = \frac{k_f \max|m(t)|}{B}$*

$$
W = n(\beta + 1)B = 
\begin{cases}
2(k_p \max|m(t)|)B & \text{PM} \\
2(k_f \max|m(t)| + B) & \text{FM}
\end{cases}

$$
Increasing the **amplitude** of the modulating signal **has almost the same effect in PM and FM**.
Increasing $B$ has a **more profound increase in bandwidth of PM signal than an FM signal.**
![[Pasted image 20240730232848.png|400]]

---
#### 1.6.2 Carson's Rule
- Phase and frequency modulation generally expand the bandwidth
- For a general message signal $m(t)$ with bandwidth $B$ Hz can be approximated by the following signal. It will contain 98% of the power band:
$$W = 2(\beta + 1)B$$
Here
- for **PM**: $\beta = k_p \max|m(t)|$
- for **FM**: $\beta = \frac{k_f \max|m(t)|}{B}$

**Maximum Phase and Frequency Deviation**
- Maximum phase deviation: $\Delta p = k_p \max|m(t)|$
- Maximum frequency deviation: $\Delta f = k_f \max|m(t)|$

**Example:** [[week 2 example 2.jpeg]]

---
#### 1.6.3 Narrowband Angle Modulation $\beta < 0.5$
This occurs when $\beta < 0.5$ and $\phi(t) \ll 1$. 

Notes on the math below: When $\cos[\phi(t)]$ is close to 0, it cane be reduced to 1, and when $sin[\phi(t)]$ is close to 0, it is equal to just $\phi(t)$

![[Pasted image 20240730174726.png#invert_B|400]]

Where
- for **PM**: $\phi (t) = k_p m(t)$
- for **FM**: $\phi (t) = 2 \pi k_f \int^t_0 m(\tau)d \tau$

**Modulated signal bandwidth**: $W = 2(\beta + 1)B \approx 2B$ (AKA similar to AM bandwidth)

This signal is similar to an DSB-FC AM signal, except that the message signal is modulated on a sine carrier instead of a cosine carrier. 
**CONS:**
Narrowband angle modulation (low-index angle modulation) does not provide better noise immunity than AM, therefore it is seldom used on its own in practical communication systems.

---
#### 1.6.4 Wideband Angle Modulation
Assume the message signal is a sinusoidal signal, i.e. $\phi(t)= \beta \sin(2\pi f_m t)$, then:

![[Pasted image 20240730180005.png#invert_B|500]]

Using **Jacobi-Anger expansion**,we can expand the nested cosine:

![[Pasted image 20240730181846.png|500]]
Where:
- $J_k(\beta)$ - coefficient of **Bessel functions** of the first kind, of order $k$ and argument $\beta$

From the above results we can combine equations (1) and (2) to get the following solution for the **wideband FM modulated signal**

![[Pasted image 20240730182019.png|300]]

Therefore the spectrum $s(t)$ has spectral components at:
- the **carrier frequency** $2\pi f_c$ of $A_c J_0 (\beta)$
- an infinite number of side-bands at $2 \pi (f_c \pm \mathbf{nf_m})$ of $A_c j_{\pm n}(\beta)$

How to determine what sidebands are significant:
- Commonly adopted rule: **those for which $|J_{\pm n}(\beta) \geq 0.1|$ and for large $\beta$, $n \approx \beta$ for this condition (replace the bounds with $\beta$)**
- Effective bandwidth according to Carson's rule: $W = 2(\beta + 1)f_m$ contains at least 98% of signal power

---
**Bessel Function - Identities**

**MATLAB** - `besselj(n,B)`

![[Pasted image 20240730181725.png]]

**top n side B**
![[Pasted image 20240730232224.png]]


### 1.7 Frequency Domain Representation

![[Pasted image 20240804202412.png]]


### 1.8 Power of FM Modulated Signal

Given the energy and power of a signal:
$$\begin{align}
& E_x = \int^{\infty}_{- \infty} |x(t)|^2 dt & \text{Energy} \\
& P_x = \lim_{T \rightarrow \infty} \frac{1}{T} \int^{T/2}_{-T/2} |x(t)|^2 dt  = \sum^\infty_{-\infty} |X_n(f)|^2 & \text{Power}

\end{align}
$$
**Parseval Theorem:** Energy/Power in time domain is equal to the energy/power in frequency domain

thus, total power of FM modulated signal:
![[Pasted image 20240804203544.png]]
 
 NOTE: formula is $\frac{A_c^2}{2R}$ where R is the resistor value, assumed to be 1 if not given.

---


## 2 Angle Modulators and Demodulators

### 2.1 Method 1 (VCO)
- FM can be generated using a **Voltage Controlled Oscillator (VCO)**
- A varactor diode is a capacitor whose capacitance changes with applied voltage. This capacitor can be used in the tuned circuit of an oscillator. If message signal is applied to varactor, the output frequency of the oscillator will change in accordance with the message signal.

![[Pasted image 20240805120703.png|400]]

The time varying capacitance of the varactor diode is given by:
$$C_V(t) = C_a + k_0 m(t)$$
When $m(t)=0$, the frequency of the tuned circuit is given by $f_c = \frac{1}{2\pi\sqrt{LC_a}}$
Instantaneous Frequency when $m(t) \neq 0$: $f_i(t) \approx f_c(1-\frac{k_0}{2C_\alpha}m(t))$

[[ifreq FM proof.jpeg]]

### 2.2 Method 2 (Narrowband)

![[Pasted image 20240805140230.png]]

- The output of narrowband angle-modulator: $u(t) = A_c \cos[2\pi f_c t + \phi(t)]$
- Output of frequency multiplier: $y(t) = A_c \cos[n2\pi f_c t + n \phi(t)]$. This is a wideband angle-modulated signal, but it is not at the desired frequency.
- Choose appropriate Local Oscillator frequency and mix with $y(t)$, resulting in frequenct $s(t) = A_c \cos[(2\pi (nf_c - f_{LO})t + n \phi (t))]$

### 2.3 Implementation of angle demodulators
FM demodulators are implemented by generating an AM signal whose amplitude is proportional to the instantaneous frequency of the FM signal. Then use an AM demodulator to recover the message signal.

![[Pasted image 20240807152403.png|400]]

#### 2.3.1 FM to AM converter (FM Discriminator circuit)
LTI system whose frequency response is approximately a straight line in the frequency band of the FM signal
Uses a differentiator for which $|H(f)| = 2\pi f$
![[Pasted image 20240808101649.png|500]]

>[!Definition]
> ### AM vs FM
> - FM capture effect: A phenomenon associated with FM reception which only the stringer of two signals at or near the same frequency will be demodulated
> 	- The complete suppression of the weaker signal occurs at the receiver limiter, where it is treated as noise and rejected.
> 	- Then both signals are nearly equal in strength, or are fading independently, the receiver may switch from one to the other.
> - $W_{AM} < W_{FM}$
> - FM rejects amplitude noise such as lightening and man made noise
> - the FM demodulator may be a PLL, Ratio Detector, Discriminator, or slope detector


![[Pasted image 20240811190212.png]]
![[Pasted image 20240811190228.png]]
![[Pasted image 20240811190245.png]]
![[Pasted image 20240811190256.png]]
![[Pasted image 20240811190324.png]]
